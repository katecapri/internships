INTERNSHIPS_POINTS_MIGRATIONS_PROJECT ?= internships-points-migrations-project
INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_VERSION ?= 0.0.1
INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_NAME ?= internships-points-migrations
INTERNSHIPS_POINTS_DB_NAME ?= internshipspointsbackenddb
INTERNSHIPS_POINTS_DB_USERNAME ?= internshipspointsbackenddb
INTERNSHIPS_POINTS_DB_PASSWORD ?= internshipspointsbackenddbpwd
INTERNSHIPS_POINTS_DB_PORT ?= 5432
INTERNSHIPS_POINTS_DB_HOST ?= points-db
INTERNSHIPS_POINTS_PROXY_NETWORK ?= "internships-network"


.PHONY: run
run:
	- docker network create $(INTERNSHIPS_POINTS_PROXY_NETWORK)
	sleep 1
	APP_POINTS_MIGRATIONS_IMAGE_VERSION=$(INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_VERSION) \
    APP_POINTS_MIGRATIONS_IMAGE_NAME=$(INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_NAME) \
    APP_PROXY_NETWORK=$(INTERNSHIPS_POINTS_PROXY_NETWORK) \
    APP_POINTS_DB_USERNAME=$(INTERNSHIPS_POINTS_DB_USERNAME) \
    APP_POINTS_DB_PASSWORD=$(INTERNSHIPS_POINTS_DB_PASSWORD) \
    APP_POINTS_DB_NAME=$(INTERNSHIPS_POINTS_DB_NAME) \
    APP_POINTS_DB_PORT=$(INTERNSHIPS_POINTS_DB_PORT) \
    APP_POINTS_DB_HOST=$(INTERNSHIPS_POINTS_DB_HOST) \
    docker-compose -p $(INTERNSHIPS_POINTS_MIGRATIONS_PROJECT) -f docker-compose.yaml up -d

.PHONY: build
build:
	docker build -t $(INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_NAME):$(INTERNSHIPS_POINTS_MIGRATIONS_IMAGE_VERSION) -f Dockerfile .
