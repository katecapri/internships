INTERNSHIPS_MESSAGE_BROKER_PROJECT ?= internships-message-broker-project
INTERNSHIPS_MESSAGE_BROKER_IMAGE_VERSION ?= 0.0.1
INTERNSHIPS_MESSAGE_BROKER_IMAGE_NAME ?= internships-message-broker
INTERNSHIPS_MESSAGE_BROKER_USERNAME ?= internshipsbackendmessagebroker
INTERNSHIPS_MESSAGE_BROKER_PASSWORD ?= internshipsbackendmessagebrokerpwd
INTERNSHIPS_NETWORK ?= "internships-network"

.PHONY: build
build:
	docker build -t $(INTERNSHIPS_MESSAGE_BROKER_IMAGE_NAME):$(INTERNSHIPS_MESSAGE_BROKER_IMAGE_VERSION) -f Dockerfile .

.PHONY: run
run:
	- docker network create $(INTERNSHIPS_NETWORK)
	APP_PROXY_NETWORK=$(INTERNSHIPS_NETWORK) \
	APP_MESSAGE_BROKER_IMAGE_VERSION=$(INTERNSHIPS_MESSAGE_BROKER_IMAGE_VERSION) \
	APP_MESSAGE_BROKER_IMAGE_NAME=$(INTERNSHIPS_MESSAGE_BROKER_IMAGE_NAME) \
    APP_MESSAGE_BROKER_USERNAME=$(INTERNSHIPS_MESSAGE_BROKER_USERNAME) \
    APP_MESSAGE_BROKER_PASSWORD=$(INTERNSHIPS_MESSAGE_BROKER_PASSWORD) \
	docker-compose -p $(INTERNSHIPS_MESSAGE_BROKER_PROJECT) -f docker-compose.yaml up -d
